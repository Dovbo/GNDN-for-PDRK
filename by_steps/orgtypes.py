import json
import collections

ORG_TYPES = {
    "govservice": "Державні служби",
    "execservice": "Виконавчі служби",
    "busstation": "Автовокзали",
    "airport": "Аеропорти",
    "police": "Відділення міліції",
    "milunit": "Військові частини",
    "roadpolice": "ДАІ",
    "shelter": "Дитячі будинки, притулки",
    "infoservice": "Довідкові служби",
    "kindergarten": "Дошкільні навчальні заклади, дитячі садки",
    "railway": "Залізничні вокзали",
    "inspection": "Інспекції",
    "LKP": "ЛКП",
    "custom": "Митниці",
    "citycounsil": "Міська рада",
    "morgue": "Морги",
    "regionadm": "Обласна адміністрація",
    "passservice": "Паспортні служби",
    "embassy": "Посольства",
    "postoffice": "Пошта",
    "privateschool":
    "Приватні навчальні заклади",
    "prosecutors": "Прокуратура",
    "RAGS": "РАГСи",
    "districtadm": "Районні адміністрації",
    "service": "Служби, інспекції",
    "court": "Суди",
    "prison": "Тюрми, колонії, СІЗО",
    "foundation": "Фонди",
    "church": "Церкви, костели, релігійні громади",
    "school": "Школи, гімназії, ліцеї",
    'transport': 'Транспорт',
    'tax': 'Податки',
    'lib': 'Бібліотеки',
    'housing': 'Комунальне господарство',
    'hospital': 'Лікарні',
    'social': 'Соціальна сфера',
    'highschool': 'ВНЗ',
    'emergency': 'Аварійні служби',
    'others ': 'Інші',

}


ORG_TYPES_MATCHER = {
    "Служби, інспекції, суди, фонди.": "inspection",
    "Санэпидемстанция": "inspection",
    "Служби, інспекції": "inspection",
    "Інспекції": "inspection",
    "Инспекции": "inspection",
    "Инспекции ": "inspection",

    "Налоговые инспекции": "tax",
    "Налоговые службы": "tax",
    "Податкові інспекції": "tax",

    "Государственные фонды и ассоциации": "foundation",
    "Благотворительные фонды": "foundation",
    "Пенсионные фонды": "foundation",
    "Фонди": "foundation",
    "Фонды": "foundation",
    "Службы, инспекции, суды, фонды": "foundation",
    "Службы, инспекции, суды, фонды.": "foundation",
    "Службы, инспекции, фонды": "foundation",
    "Службы и фонды": "foundation",
    "Служби, фонди": "foundation",

    "Ведомства": "govservice",
    "Комитеты": "govservice",
    "Контрольно-счетная палата": "govservice",
    "Міністерство доходів і зборів України": "govservice",
    "Государственные службы": "govservice",
    "Державні заклади та установи": "govservice",
    "Державні служби": "govservice",
    "Держзаклади України": "govservice",
    "Держслужби України": "govservice",

    "Госучереждения Авдеевки": "govservice",
    "Госучереждения Артемовска": "govservice",
    "Госучереждения Днепропетровской области": "govservice",
    "Госучереждения Донецкой области": "govservice",
    "Госучереждения Енакиево": "govservice",
    "Госучереждения Житомира": "govservice",
    "Госучереждения Ильичевска": "govservice",
    "Госучереждения Кировограда": "govservice",
    "Госучереждения Краматорска": "govservice",
    "Госучереждения Красноармейска и Димитрова": "govservice",
    "Госучереждения Крыма": "govservice",
    "Госучереждения Крыма Севастополь": "govservice",
    "Госучереждения Николаевской области": "govservice",
    "Госучереждения Сумской области": "govservice",
    "Госучереждения Черниговской области": "govservice",
    "Госучреждения Запорожской области": "govservice",
    "Госучреждения Луганской области": "govservice",
    "Госучреждения Полтавской области": "govservice",
    "Госучреждения Украины": "govservice",
    "Госучреждения Херсона": "govservice",

    "Обладминистрации": "regionadm",
    "Обладминистрация": "regionadm",
    "Обласна адміністрація": "regionadm",
    "Областная  администрация": "regionadm",
    "Областная администрация": "regionadm",
    "Закарпатська обласна державна адміністрація": "regionadm",
    "Кировоградская областная государственная администрация": "regionadm",

    "Луганский областной совет": "regionadm",

    "Органи місцевого самоврядування": "citycounsil",

    "Міська рада": "citycounsil",
    "Городской совет": "citycounsil",

    "Винницкий городской совет": "citycounsil",
    "Івано-Франківська міська рада": "citycounsil",
    "Администрация города": "citycounsil",
    "Артемовский городской совет": "citycounsil",
    "Городские советы Луганской области": "citycounsil",
    "Городской совет Енакиево": "citycounsil",
    "Городской совет Севастополя": "citycounsil",
    "Днепродзержинский городской совет": "citycounsil",
    "Донецкий городской совет": "citycounsil",
    "Житомирский городской совет": "citycounsil",
    "Запорожский городской совет": "citycounsil",  
    "Красноармейский  городской совет": "citycounsil",
    "Кременчугский городской совет": "citycounsil",
    "Луганский городской совет": "citycounsil", 
    "Луцька міська рада": "citycounsil",
    "Макеевский городской совет": "citycounsil",
    "Николаевский городской совет": "citycounsil",
    "Одесский городской совет": "citycounsil",
    "Полтавский городской совет": "citycounsil",
    "Черкасский городской совет": "citycounsil",
    "Херсонский городской совет": "citycounsil",
    "Ужгородська міська рада": "citycounsil",
    "Сумкой городской совет": "citycounsil",
    "Тернопільська міська рада": "citycounsil",    
    "Славянский городской совет": "citycounsil",

    "Красноармейские  районые советы": "citycounsil",
    "Славянская районная администрация": "districtadm",
    "Поселковые советы": "citycounsil",
    "Поселковые советы Луганска": "citycounsil",

    "Сельские районы и райцентры": "citycounsil",
    "Селищні ради": "citycounsil",

    "Администрации, городская и районная": "districtadm",
    "Райадминистрации": "districtadm",
    "Райадминистрации ": "districtadm",
    "Райгосадминистрации Кировоградской области": "districtadm",
    "Районные  администрации": "districtadm",
    "Районные администрации": "districtadm",
    "Районные администрации Горловки": "districtadm",
    "Районные администрации Днепродзержинска": "districtadm",
    "Районные администрации Донецка": "districtadm",
    "Районные администрации Енакиево": "districtadm",
    "Районные администрации Запорожья": "districtadm",
    "Районные администрации Луганска": "districtadm",
    "Районные администрации Николаева": "districtadm",
    "Районные администрации Полтавы": "districtadm",
    "Районные администрации Сум": "districtadm",
    "Районные админстрации": "districtadm",
    "Районні адміністрації": "districtadm",
    "Районні державні адміністрації": "districtadm",

    "Виконавчі служби": "execservice",
    "Исполком городского совета": "execservice",
    "Исполкомы районных советов": "execservice",
    "Исполнительные органы городского совета": "execservice",
    "Исполнительные службы": "execservice",
    "Виконавчі органи міської ради": "execservice",
    "Исполнительный комитет Макеевского городского совета": "execservice",
    "Органы исполнительной власти": "execservice",

    "Управления Макеевского городского совета": "citycounsil",

    " Паспортные службы": "passservice",
    "Государственная миграционная служба": "passservice",
    "Федеральные миграционные службы": "passservice",
    "Міграційні служби": "passservice",
    "Паспортные отделения": "passservice",
    "Паспортные службы": "passservice",
    "Паспортные столы": "passservice",
    "Паспортні служби": "passservice",
    "Центры регистрации граждан в Чернигове": "passservice",

    "Регистрационные службы": "passservice",

    "Консульства": "embassy",
    "Посольства": "embassy",

    "ЗАГС": "RAGS",
    "ЗАГСы": "RAGS",
    "РАГСи": "RAGS",
    "РАГСы": "RAGS",
    "РАГСы (ЗАГСы)": "RAGS",
    "РАЦСи": "RAGS",
    "РАЦСи (РАЦСи)": "RAGS",
    "РаГСЫ": "RAGS",

    "Центр занятости": "social",
    "Центри зайнятості": "social ",
    "Центры занятости": "social ",
    "Центры зянятости": "social ",
    "Социальная помощь населению": "social",
    "Социальные службы": "social",

    "БТІ": "housing",
    "БТИ": "housing",
    "БТИ ": "housing",
    "БТИ (Бюро технической инвентаризации)": "housing",

    "Коммунальные службы": "housing",
    "Комунальні підприємства": "housing",
    "ЖКХ": "housing",
    "ЖКХ (Жилищно-коммунальные предприятия)": "housing",
    "Жилищно-коммунальное хозяйство, МУП": "housing",
    "Жилищно-коммунальные предприятия": "housing",
    "Жилищно-коммунальные предприятия (ЖКХ)": "housing",
    "Житлово - комунальні підприємства (ЖКХ)": "housing",
    "Житлово-комунальні підприємства": "housing",
    "Житлово-комунальні підприємства (ЖКГ)": "housing",
    "Житлово-комунальні служби": "housing",
    "ЛКП": "housing",

    "Інформаційно-довідкові служби": "infoservice",
    "Аварийные и справочные службы": "infoservice",
    "Довідкові служби": "infoservice",
    "Спавочные службы": "infoservice",
    "Справочные": "infoservice",
    "Справочные службы": "infoservice",

    "Аварийные службы": "emergency",
    "Аварійні служби": "emergency",
    "Аварійні та екстренні служби": "emergency",
    "Куди дзвонити в екстрених випадках": "emergency",
    "Куда звонить в экстренных случаях": "emergency",
    "Пожарная охрана": "emergency",
    "Пожарные части": "emergency",
    "Пожежні частини та рятувальні служби": "emergency",
    "Районні пожежно-рятувальні служби": "emergency",
    "Экстренные службы": "emergency",

    "Медицинские учреждения города": "hospital",
    "Медичні заклади": "hospital",
    "Больницы": "hospital",
    "Больницы, поликлиники, морги": "hospital",
    "Ветеринарна допомога": "hospital",
    "Ветеринарная помощь": "hospital",
    "Городские Больницы": "hospital",
    "Лікарні": "hospital",
    "Лікарні, поліклініки": "hospital",
    "Поликлиники": "hospital",
    "Поликлиники, больницы": "hospital",
    "Поліклініки": "hospital",
    "Роддома": "hospital",

    "Кладбища": "morgue",
    "Кладбища и крематории": "morgue",
    "Кладбища, Крематории, Морги": "morgue",
    "Кладбища, крематории, морги": "morgue",
    "Кладовища": "morgue",
    "Кладовища і крематорії": "morgue",
    "Морги": "morgue",
    "Морги, кладовища": "morgue",
    "Морги,кладовища": "morgue",

    "Службы связи": "postoffice",
    "Отделения связи": "postoffice",
    "Почта": "postoffice",
    "Почтовые отделения": "postoffice",
    "Пошта": "postoffice",
    "Пошта ": "postoffice",
    "Пошти": "postoffice",

    "Транспорт": "transport",
    "Автовокзали": "transport",
    "Автовокзали, залізничний вокзал": "transport",
    "Автовокзали, залізничні вокзали": "transport",
    "Автовокзалы": "transport",
    "Автовокзалы и аэропорт": "transport",  
    "Аеропорт": "transport",
    "Аеропорти": "transport",
    "Аэропорт": "transport",
    "Аэропорты": "transport",
    "Вокзалы": "transport",
    "Вокзалы и аэропорт": "transport",
    "Ж/Д вокзал": "transport",
    "Ж/Д вокзали": "transport",
    "Ж/Д вокзалы": "transport",
    "Ж/д вокзалы": "transport",
    "Железнодорожные вокзалы": "transport",
    "Залізничний вокзал": "transport",
    "Залізничні вокзали": "transport",
    "Морские порты": "transport",
    "Порты": "transport",
    "Речной вокзал": "transport",
    "Речные порты": "transport",
    "Речпорт": "transport",

    "Митниці": "custom",
    "Таможни": "custom",
    "Таможня": "custom",

    "Архивы": "lib",
    "Библиотека": "lib",   
    "Бібліотеки": "lib",

    "Детские дома и приюты": "shelter",
    "Детские дома, приюты": "shelter",
    "Дитячі будинки та притулки": "shelter",
    "Дитячі будинки, притулки": "shelter",
    "Дитячі будинки,притулки": "shelter",

    "Детские сады": "kindergarten",
    "Дитячі садочки": "kindergarten",
    "Дошкільні навчальні заклади, дитячі садки": "kindergarten",

    "Навчальні заклади": "school",
    "Образование": "school",
    "Отдел образования": "citycounsil",
    "Приватні навчальні заклади": "school",
    "Центры развития и творчества": "school",
    "Школи": "school",
    "Школи, гімназії, ліцеї": "school",
    "Школы": "school",
    "Школи інтернати": "school",
    "Школы интернаты": "school",
    "Школы, Интернаты": "school",
    "Лицеи": "school",
    "Лицеи, Гимназии": "school",
    "Ліцеї": "school",
    "Коледжи": "school",
    "Коледжі": "school",
    "Колледжи": "school",
    "Училища": "school",
    "Техникумы": "school",
    "Технікуми": "school",

    "ВУЗи": "highschool",
    "ВУЗы": "highschool",

    "Органы судебной власти и прокуратуры": "court",
    "Суди": "court",
    "Суди, інспекції": "court",
    "Суды": "court",

    "Прокуратура": "prosecutors",
    "Прокуратура,РАЦСи": "prosecutors",
    "Прокуратуры": "prosecutors",

    "Відділення міліції": "police",
    "ГУМВД Украины и РОВД": "police",
    "Ильичевский ГО милиции УМВД Украины": "police",
    "Милиция": "police",
    "Милиция и службы охраны": "police",
    "Милиция, УВД, ОВД": "police",
    "Милиция, суды, прокуратура": "police",
    "ОБОП": "police",
    "РВВС": "police",
    "РОВД": "police",
    "Районні відділи внутрішніх справ": "police",
    "УБОП": "police",  
    "Управления МВД": "police",

    "ГАИ": "police",
    "ДАІ": "police",  
    "Госавтоинспекции": "police",
    "Госавтоинспекция": "police",
    "МРЭО": "police",

    "Тюрми, колонії, СІЗО": "prison",
    "Тюрмы, колонии": "prison",
    "Тюрьмы и колонии": "prison",
    "Тюрьмы, колонии": "prison",
    "Тюрьмы, колонии, СИЗО": "prison",
    "В'язниці, СІЗО": "prison",
    "В'язниці, колонії": "prison",
    "В’язниці, колонії, СІЗО": "prison",
    "СІЗО": "prison",  
    "СИЗО": "prison",

    "Военкоматы": "milunit",
    "Военные комисариаты": "milunit",
    "Военные комиссариаты": "milunit",
    "Воинские части": "milunit",
    "Військові комісаріати": "milunit",
    "Військові частини": "milunit",
    "Бомбоубежище": "milunit",

    "Лесничества": "others",
    "Аптеки": "others",  
    "Управляющие компании": "others",
    "Услуги, МУП": "others",

    "Куда обратиться предпринимателю": "others",
    "Куда позвонить, если вы планируете поездку": "others",
    "Куди звернутися підприємцю": "others",
    "Куди подзвонити, якщо ви плануєте поїздку": "others",
    "СБУ": "others",

    "КСНы": "others",
    "Гуртожитки": "others",   
    "Общественные организации": "others",
    "Работа с предпринимателями": "others",
    "Службы доверия": "others",     

    "Храми, собори, церкви": "church",
    "Храмы": "church",
    "Храмы и Соборы": "church",
    "Храмы, соборы": "church",     
    "Церкви": "church",
    "Церкви, костели, релігійні громади": "church",
    "Церкви, костелли, релігійні громади": "church",
}


def org_types_collector(filename):
    with open(filename, 'r') as fl:
        geoobjects = json.loads(fl.read())
    collected = {}
    for item in geoobjects['features']:
        for org in item['properties']['orgs']:
            if org['category'] not in collected:
                if org['category'] in ORG_TYPES_MATCHER:
                    collected[org['category']] = ORG_TYPES_MATCHER[org['category']]
                else:
                    collected[org['category']] = ''

    collected = collections.OrderedDict(sorted(collected.items(), key=lambda t: t[0]))
    with open('collected_org_types.json', 'w') as fl:
        fl.write(json.dumps(collected, indent=4, ensure_ascii=False))

if __name__ == '__main__':
    # org_types_collector('all_cities.geojson')

    matcher_types = set(ORG_TYPES_MATCHER.values())
    legal_types = set(ORG_TYPES.keys())
    print(matcher_types - legal_types)
